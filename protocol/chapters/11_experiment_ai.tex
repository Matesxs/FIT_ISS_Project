\section{Experiment filtrace neuronovou sítí}

V této části, která je mimo oficiální zadání, se testuje možnost filtrace pomocí neuronových sítí.
Před vytvořením prvního prototypu, který byl schopen vytvořit aspoň nějaký signál bylo potřeba určit jaká data bude vůbec neuronová síť zpracovávat.
Po několik experimentech bylo určeno, že vstupní data budou normalizované hodnoty 4096 raw hodnot signálu, výstup fourierovy transformace této části signálu a vzorkovací frekvence.
Jako dataset byli použity stažené mp3 audio stopy náhodných youtube videí, které byli následně převedeny na wav formát a normalizovány na hodnoty -1 - 1, poté zarušeny náhodným rušením (náhodná amplituda 0 - 4, s náhodnou frekvení 0 - 48kHz a náhodnou fází).
Pro zjištění výkonu neuronové sítě byl využit ukazatel MSE (Mean Square Error - průměrná střední odchylka) a SNR (Signal to Noise Ratio).


\subsection{Prototyp 1}

První prototyp byl schopný vytvořit aspoň nějaký signál, který vypadá že je bez rušení, ale zároveň nebyla neuronová sít schopná zreplikovat ani dobrou část signálu.
Toto chování bude nejspíš způsobeno kapacitou neuronové sítě - pro testování učícího scriptu byl vytvořen pouze malý model, aby bylo trénování rychlé.
Po 5.5h trénování byla dosažena maximální kapacita modelu (validační SNR dále nerostlo) a tak bylo trénování tohoto prototypu ukončeno.
Tento model se byl schopný dostat na SNR 30, což není vůbec špatná, ale u audio signálů je tato hodnota stále příliš malá.

Jako model byl použit malý autoencoder pro 1D data s residuálními spoji, které zaručují lepší propagaci nezpracovaných dat dále do model.
Množství trénovatelných parametrů tohoto modelu je 35M, takže tento model není úplně malý, ale je to hlavně způsobeno rozměrem vstupních dat.

Tento model byl trénován na batch size 64 a 5000 batchí na epochu po dobu asi 60 epoch. Jeden sample batche obsahoval jeden úsek signálu (4096 vzorků), hodnoty FFT pro tento úsek (taky 4096 vzorků) a vzorkovací frekvenci.

\begin{figure}[H] 
	\centering
	\includegraphics[scale=0.25,keepaspectratio]{model_1.png}
	\caption{Konstrukce modelu neuronové stítě prototypu 1}
\end{figure}

\begin{landscape}
\begin{figure}[H] 
	\centering
	\includegraphics[scale=0.5,keepaspectratio]{Figure_33.png}
	\caption{Vyčištěný signál s použitím neuronové sítě prototypu 1}
\end{figure}
\end{landscape}


\subsection{Prototyp 2}

V tomto prototypu byl model pouze zvětšen, velikosti dense vrstev byly nastaveny na dvojnásobnou velikost. I když došlo skoro k zdvojnásobení kapacity tak se model stále moc nezlepšil, takže další dalším krokem bude přidání více vrstev.
Tento model se dostal na SNR 31 a MSE 0.0017, ale stále to nebylo dostatečné aby tento signál aspoň připomínal vyčištěný signál klasickým filtrem.

\begin{figure}[H] 
	\centering
	\includegraphics[scale=0.25,keepaspectratio]{model_2.png}
	\caption{Konstrukce modelu neuronové stítě prototypu 2}
\end{figure}

\begin{landscape}
	\begin{figure}[H] 
		\centering
		\includegraphics[scale=0.5,keepaspectratio]{Figure_34.png}
		\caption{Vyčištěný signál s použitím neuronové sítě prototypu 2}
	\end{figure}
	\end{landscape}